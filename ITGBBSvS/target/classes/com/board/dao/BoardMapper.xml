<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper   
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"   
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">  
    
<mapper namespace="Board">  
 	<select id="selectList" parameterType="map"  resultType="BoardCommand">
 	                                
 	    SELECT  seq, writer, title, content,pwd,hit,regdate,filename
    	    FROM(SELECT
    		    a.*,
    		        rownum rnum
    		FROM (SELECT   *
    				      FROM springboard2
    				<where>
    				   <if test="keyWord!=null and keyField=='title'">
    				         title like '%' || #{keyWord} || '%'
    				   </if>
    				   <if test="keyWord!=null and keyField=='writer'">
    				         writer like '%' || #{keyWord} || '%'
    				   </if>
    				   <if test="keyWord!=null and keyField=='content'">
    				         content like '%' || #{keyWord} || '%'
    				   </if>
    				   <if test="keyWord!=null and keyField=='all'">
    				         title like '%' || #{keyWord} || '%'  or
    				         writer like '%' || #{keyWord} || '%' or
    				         content like '%' || #{keyWord} || '%'
    				   </if>
    				</where>
    				ORDER BY seq desc)a)
	<![CDATA[
		WHERE rnum >= #{start} AND rnum <= #{end}
	]]>
 	</select>
 	
 	<select id="selectCount" parameterType="map" resultType="Integer">
 	    SELECT  count(*)  FROM springboard2
    		<where>
    				   <if test="keyWord!=null and keyField=='title'">
    				         title like '%' || #{keyWord} || '%'
    				   </if>
    				   <if test="keyWord!=null and keyField=='writer'">
    				         writer like '%' || #{keyWord} || '%'
    				   </if>
    				   <if test="keyWord!=null and keyField=='content'">
    				         content like '%' || #{keyWord} || '%'
    				   </if>
    				   <if test="keyWord!=null and keyField=='all'">
    				         title like '%' || #{keyWord} || '%'  or
    				         writer like '%' || #{keyWord} || '%' or
    				         content like '%' || #{keyWord} || '%'
    				   </if>
    		</where>
 	</select>
 
 <!--최대값 구하기 데이터가 없으면 0을 반환 X NullPointerException반환 -->
 <select id="getNewSeq" resultType="int">
    select max(seq) from springboard2
 </select>
 
 <!-- 글쓰기 -->
 <insert id="insertBoard" parameterType="BoardCommand">
     insert into springboard2(seq,writer,title,content,pwd,hit,regdate,filename)
     values(#{seq},#{writer},#{title},#{content},#{pwd},0,sysdate,
                #{filename,jdbcType=VARCHAR})
 </insert>
 
 <!-- 글 내용보기 -->
 <select id="selectBoard" parameterType="Integer"  resultType="BoardCommand">
 	select * from springboard2 where seq=#{seq}
 </select>
 
 <!-- 조회수 증가 -->
 <update id="updateHit" parameterType="int">
 	update springboard2 set hit=hit+1 where seq=#{seq}
 </update>
 
 <!-- 글 수정하기 -->
 <update id="updateBoard" parameterType="BoardCommand">
 	update springboard2 set writer=#{writer}, title=#{title}, content=#{content}, filename=#{filename:VARCHAR} where seq=#{seq}
 </update>
 
 <!-- 글 삭제하기 -->
 <delete id="deleteBoard" parameterType="int">
 	delete from springboard2 where seq=#{seq}
 
 </delete>
 
</mapper>







